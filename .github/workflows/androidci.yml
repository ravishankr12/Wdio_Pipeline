name: Android UI Tests

on: [push]

jobs:
  build:
    runs-on: ubuntu-22.04  # âœ… Use stable runner

    steps:
      - name: ğŸ§¾ Checkout repository
        uses: actions/checkout@v3

      - name: ğŸ”§ Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18.0

      - name: ğŸ“¦ Install dependencies
        run: |
          echo "ğŸ“¦ Running npm install..."
          npm install
          echo "âœ… Dependencies installed."

      - name: ğŸ§ª Run Tests
        env:
          BS_USER: ${{ secrets.BS_USER }}
          BS_KEY: ${{ secrets.BS_KEY }}
        run: |
          echo "ğŸ§ª Starting tests with WebdriverIO..."
          npx wdio wdio.conf.js
          echo "âœ… Test run completed."

          - name: ğŸ“Š Generate Allure Report
          if: always()
          run: |
            echo "ğŸ“Š Generating Allure report..."
            npx allure generate allure-results --clean -o allure-report
            echo "ğŸ“ Allure report generated at: $(pwd)/allure-report"
            echo "ğŸ“„ HTML index: $(pwd)/allure-report/index.html"
  
          - name: ğŸ“‚ List Report Directory (Debug)
          if: always()
          run: |
            echo "ğŸ§¾ Listing contents of allure-report:"
            ls -R allure-report
