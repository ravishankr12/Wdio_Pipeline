name: Android UI Tests

on: [push]

jobs:
  build:
    runs-on: ubuntu-22.04  # âœ… Use stable runner

    steps:
      - name: ðŸ§¾ Checkout repository
        uses: actions/checkout@v3

      - name: ðŸ”§ Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18.0

      - name: ðŸ“¦ Install dependencies
        run: |
          echo "ðŸ“¦ Running npm install..."
          npm install
          echo "âœ… Dependencies installed."

      - name: ðŸ§ª Run Tests
        env:
          BS_USER: ${{ secrets.BS_USER }}
          BS_KEY: ${{ secrets.BS_KEY }}
        run: |
          echo "ðŸ§ª Starting tests with WebdriverIO..."
          npx wdio wdio.conf.js
          echo "âœ… Test run completed."

      - name: ðŸ§° Generate Allure Report
        if: always() # ensures it runs even if tests fail
        run: |
          echo "ðŸ“Š Generating Allure report..."
          npx allure generate allure-results --clean -o allure-report
          echo "âœ… Allure report generated."

      - name: ðŸ“¤ Upload Allure Report
        if: always()
        uses: actions/upload-artifact@v3
        with:
          name: allure-report
          path: allure-report
